import * as PIXI from 'pixi.js';
import GameManager from './managers/GameManager';
import InputManager from './managers/InputManager';

class QuickWallHeroApp {
  constructor() {
    // Create PIXI Application
    this.app = new PIXI.Application({
      width: window.innerWidth,
      height: window.innerHeight,
      backgroundColor: 0x1a1a1a,
      antialias: true,
      resolution: window.devicePixelRatio || 1,
      autoDensity: true
    });
    
    // Add canvas to DOM
    document.body.appendChild(this.app.view);
    
    // Set up resize handler
    window.addEventListener('resize', this.resize.bind(this));
    
    // Create game manager
    this.gameManager = new GameManager(this.app);
    
    // Create input manager
    this.inputManager = new InputManager(this.app, this.gameManager);
    
    // Start game loop
    this.app.ticker.add(this.update.bind(this));
  }
  
  update(delta) {
    // Convert to seconds (ticker delta is in frames, ~1/60 seconds each)
    const deltaTime = delta / 60;
    
    // Update game manager
    this.gameManager.update(deltaTime);
  }
  
  resize() {
    // Resize renderer
    this.app.renderer.resize(window.innerWidth, window.innerHeight);
    
    // Notify game manager
    this.gameManager.resize(window.innerWidth, window.innerHeight);
  }
}

export default QuickWallHeroApp;